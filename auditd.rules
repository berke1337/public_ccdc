# Delete any preexisting rules before starting to define new ones.
-D

# Set the number of buffers to take the audit messages. Depending on the level of audit logging on your system, increase or decrease this figure.
-b 8192

# Set the failure flag to use when the kernel needs to handle critical errors. Possible values are 0 (silent), 1 (printk, print a failure message), and 2 (panic, halt the system).
-f 2


# Track task creation.
-a entry,always -S clone2 -k medium

# Add an audit context to the umask system call.
-a entry,always -S umask -k medium


# Watch the audit logs and config files
-w /var/log/audit/ -k high
-w /var/log/audit/audit.log -k high

-w /etc/auditd.conf -p wa -k high
-w /etc/audit.rules -p wa -k high
-w /etc/libaudit.conf -p wa -k high
-w /etc/sysconfig/auditd -p wa -k high


# Enable an audit context for system calls related to changing file ownership and permissions. Depending on the hardware architecture of your system, enable or disable the *32 rules. 64-bit systems, like x86_64 and ia64, require the *32 rules to be removed.
-a entry,always -S chmod -S fchmod -S chown -S chown32 -S fchown -S fchown32 -S lchown -S lchown32 -k medium

# Enable an audit context for system calls related to file content modification. Depending on the hardware architecture of your system, enable or disable the *64 rules. 64-bit systems, like x86_64 and ia64, require the *64 rules to be removed.
-a entry,always -S creat -S open -S truncate -S truncate64 -S ftruncate -S ftruncate64 -k low

# Enable an audit context for any directory operation, like creating or removing a directory.
-a entry,always -S mkdir -S rmdir -k low

# Enable an audit context for any linking operation, such as symlink, link, unlink, or rename.
-a entry,always -S unlink -S rename -S link -S symlink  -k medium

# Enable an audit context for any operation related to extended file system attributes.
-a entry,always -S setxattr -k high
-a entry,always -S lsetxattr -k high
-a entry,always -S fsetxattr -k high
-a entry,always -S removexattr -k high
-a entry,always -S lremovexattr -k high
-a entry,always -S fremovexattr -k high

# Enable an audit context for the mknod system call, which creates special (device) files.
-a entry,always -S mknod -k high

# Enable an audit context for any mount or umount operation. For the x64_64 architecture, disable the umount rule. For the ia64 architecture, disable the umount2 rule.
-a entry,always -S mount -S umount -S umount2 -k high


# More Watches
-w /var/spool/at -k high
-w /etc/at.allow -k high
-w /etc/at.deny -k high

-w /etc/cron.allow -p wa -k high
-w /etc/cron.deny -p wa -k high
-w /etc/cron.d/ -p wa -k high
-w /etc/cron.daily/ -p wa -k high
-w /etc/cron.hourly/ -p wa -k high
-w /etc/cron.monthly/ -p wa -k high
-w /etc/cron.weekly/ -p wa -k high
-w /etc/crontab -p wa -k high
-w /var/spool/cron/root -k high


-w /etc/group -p wa -k high
-w /etc/passwd -p wa -k high
-w /etc/shadow -k high

-w /etc/login.defs -p wa -k high
-w /etc/securetty -k high
-w /var/log/faillog -k high
-w /var/log/lastlog -k high


-w /etc/hosts -p wa -k high
-w /etc/sysconfig/ -k high

-w /etc/inittab -p wa -k high
-w /etc/init.d/ -k high
-w /etc/init.d/auditd -p wa -k high

-w /etc/ld.so.conf -p wa -k high

-w /etc/localtime -p wa -k high

-w /etc/sysctl.conf -p wa -k high

-w /etc/modprobe.conf.d/ -k high
-w /etc/modprobe.conf.local -p wa -k high
-w /etc/modprobe.conf -p wa -k high


-w /etc/pam.d/ -k high


-w /etc/aliases -p wa -k medium
-w /etc/postfix/ -p wa -k medium


-w /etc/ssh/sshd_config -k high

-w /etc/stunnel/stunnel.conf -k high
-w /etc/stunnel/stunnel.pem -k high

-w /etc/vsftpd.ftpusers -k high
-w /etc/vsftpd/vsftpd.conf -k high


-a exit,always -S sethostname -k high
-w /etc/issue -p wa -k high
-w /etc/issue.net -p wa -k high


# More high impact Watches by tobi
-w /etc/sudoers -k high
-w /etc/sudoers.d/ -k high

# More medium impact Watches by tobi

-w /etc/ -k medium
-w /var/log/audit/audit.log -k high
